# Easybof - 300

Buffer overflows are a lot more menacing in appearance than in practice to exploit. In this challenge we exploit the vulnerable `gets()` function and return ourselves a shell.

# Prompt

![alt text](https://github.com/Jhayes97/MCCC2017-Walkthrough/blob/master/src/ebo1.PNG "Easybof")


# Guide

It provides us with the source code in the prompt, so let's break that down...


You can see that `do_system()` returns us a shell, so that is the function that we will want to call. Looking at `do_input()`, you can see that there is a variable called `key` with a hex value. Reading further down the function it appears that we want key to actually equal '0xb00bface' instead of its original value, but there appears to be no way to change the value.


# Gets()

Notice any disgusting in this sourcecode? Let's look at the man page for `gets()`

![alt text](https://github.com/Jhayes97/MCCC2017-Walkthrough/blob/master/src/ebo2.PNG "Easybof")


We can exploit the vuln function `gets()` and overwrite the key variable to contain `0xb00bface` instead, triggering `do_system()` and giving us our shell.


# From pwn import *

Pwntools is an excellent python module for CTFs, and I'll try to be incorporating some of its uses in my ongoing CTF walkthroughs

First let's put 0xb00bface into little-endian format using pwntools


![alt text](https://github.com/Jhayes97/MCCC2017-Walkthrough/blob/master/src/ebo3.PNG "Easybof")

Now, let's write a script that will connect to the server, and drop our payload. Because the given buffer size is 32, I'm going to assume we have to write 44 into it based off experience. This can be a little tedious without sourcecode.

![alt text](https://github.com/Jhayes97/MCCC2017-Walkthrough/blob/master/src/ebo4.PNG "Easybof")

Using `p.interactive()`, we can maintain a shell by preventing stdin from closing.

![alt text](https://github.com/Jhayes97/MCCC2017-Walkthrough/blob/master/src/ebo5.PNG "Easybof")

Now we exploit the binary, get a shell, check out our working directory, and cat the flag

**flag{memory_corruption_101}**

